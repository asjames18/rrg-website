import{s as i}from"./supabase.CM8HHm_J.js";import"./index.M9SNm6Va.js";import"./preload-helper.BlTxHScW.js";const a=new URLSearchParams(window.location.search),e=a.get("redirect")||"/";i.auth.onAuthStateChange(async(n,r)=>{if(r?.user&&n==="SIGNED_IN")try{const{data:o}=await i.from("profiles").select("role").eq("id",r.user.id).single(),t=o?.role==="admin"||o?.role==="editor";setTimeout(()=>{e.includes("/admin-dashboard")||e.includes("/admin-login")?t?window.location.href=e:window.location.href="/auth?error=insufficient-permissions&redirect="+encodeURIComponent(e):window.location.href=e},1500)}catch(o){console.error("Error checking user role:",o),setTimeout(()=>{window.location.href=e},1500)}});
