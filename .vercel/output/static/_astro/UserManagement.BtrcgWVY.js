import{j as e}from"./jsx-runtime.ClP7wGfN.js";import{r as s}from"./index.DK-fsZOb.js";import{s as g}from"./supabase.CM8HHm_J.js";import"./index.M9SNm6Va.js";import"./preload-helper.BlTxHScW.js";function E(){const[a,l]=s.useState([]),[b,d]=s.useState(!0),[i,c]=s.useState(null),[m,u]=s.useState(null);s.useEffect(()=>{x()},[]);const x=async()=>{try{d(!0);const{data:r,error:t}=await g.from("profiles").select("*").order("created_at",{ascending:!1});if(t)throw t;l(r||[])}catch(r){c(r instanceof Error?r.message:"Failed to fetch users")}finally{d(!1)}},h=async(r,t)=>{try{u(r);const p=await(await fetch("/api/promote-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r,role:t})})).json();if(p.success)l(a.map(o=>o.id===r?{...o,role:t}:o));else throw new Error(p.error||"Failed to promote user")}catch(n){c(n instanceof Error?n.message:"Failed to promote user")}finally{u(null)}},f=r=>{switch(r){case"admin":return"bg-red-900/30 text-red-200 border-red-700";case"editor":return"bg-amber-900/30 text-amber-200 border-amber-700";case"viewer":return"bg-neutral-800 text-neutral-300 border-neutral-700";default:return"bg-neutral-800 text-neutral-300 border-neutral-700"}};return b?e.jsx("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-neutral-700 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-3",children:[1,2,3].map(r=>e.jsx("div",{className:"h-16 bg-neutral-800 rounded"},r))})]})}):e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-amber-100",children:"User Management"}),e.jsx("button",{onClick:x,className:"bg-neutral-800 hover:bg-neutral-700 text-neutral-200 px-3 py-1.5 rounded text-sm transition-colors",children:"Refresh"})]}),i&&e.jsx("div",{className:"bg-red-900/30 border border-red-700 text-red-200 p-3 rounded mb-4",children:i}),e.jsxs("div",{className:"space-y-3",children:[a.map(r=>e.jsx("div",{className:"bg-neutral-800 border border-neutral-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"text-neutral-200 font-medium",children:r.email}),e.jsx("span",{className:`text-xs px-2 py-1 rounded border ${f(r.role)}`,children:r.role.charAt(0).toUpperCase()+r.role.slice(1)})]}),e.jsxs("div",{className:"text-sm text-neutral-400",children:["Joined: ",new Date(r.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:r.role,onChange:t=>h(r.id,t.target.value),disabled:m===r.id,className:"bg-neutral-700 border border-neutral-600 text-neutral-200 text-sm px-2 py-1 rounded focus:outline-none focus:ring-2 focus:ring-amber-500",children:[e.jsx("option",{value:"viewer",children:"Viewer"}),e.jsx("option",{value:"editor",children:"Editor"}),e.jsx("option",{value:"admin",children:"Admin"})]}),m===r.id&&e.jsx("div",{className:"text-xs text-neutral-400",children:"Updating..."})]})]})},r.id)),a.length===0&&e.jsx("div",{className:"text-center py-8 text-neutral-400",children:"No users found"})]})]})}export{E as default};
